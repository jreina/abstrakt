{"version":3,"sources":["backend/firebase.ts","hooks/useFirestoreDoc.ts","contexts/AppStateContext.ts","hooks/useAppState.ts","components/RefSearch/RefSearch.tsx","components/NewActivity/NewActivity.tsx","components/DropButton.tsx","components/TimeEntryListItem/TimeEntryListItem.tsx","components/InstanceEntryListItem/InstanceEntryListItem.tsx","components/ActivityList/ActivityList.tsx","components/RecentActivity/RecentActivity.tsx","components/Intro/Intro.tsx","App.tsx","hooks/useauth.ts","index.tsx"],"names":["firebaseApp","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebaseAppAuth","auth","providers","googleProvider","GoogleAuthProvider","useFirestoreDoc","ref","useState","isLoading","data","docState","setDocState","useEffect","onSnapshot","doc","docs","map","x","id","AppStateContext","React","createContext","user","useAppState","useContext","RefSearch","onSelect","firestore","collection","uid","refs","searchTerm","setSearchTerm","handleClick","entry","event","filtered","filter","title","includes","className","htmlFor","type","placeholder","onChange","term","target","value","onKeyDown","key","tags","autoComplete","onClick","delete","tagLens","R","NewActivity","removeFn","currentTag","setCurrentTag","selectedRef","setSelectedRef","tag","idx","a","async","add","start","moment","utc","toISOString","undefined","DropButton","dropAction","dropClicked","setDropClicked","finishEntry","update","dropForUser","TimeEntryListItem","join","badges","format","duration","end","diff","push","date","toString","time","InstanceEntryListItem","ActivityList","entries","k","RecentActivity","orderBy","limit","Intro","signIn","withFirebaseAuth","signOut","signInWithGoogle","currentUser","initializing","state","setState","unsubscribe","onAuthStateChanged","useAuth","Provider","displayName","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.abd507dc.chunk.js","sourcesContent":["import firebase from \"firebase\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyBP8Eo61hqQ5w_iHpCZMNBeTXwPXbhDoeY\",\r\n  authDomain: \"abstrakt-6eb75.firebaseapp.com\",\r\n  databaseURL: \"https://abstrakt-6eb75.firebaseio.com\",\r\n  projectId: \"abstrakt-6eb75\",\r\n  storageBucket: \"abstrakt-6eb75.appspot.com\",\r\n  messagingSenderId: \"133869053674\",\r\n  appId: \"1:133869053674:web:920e97064ef99e147c9993\",\r\n  measurementId: \"G-3R5QHNZBS9\"\r\n};\r\n// Initialize Firebase\r\nconst firebaseApp = firebase.initializeApp(firebaseConfig);\r\nconst firebaseAppAuth = firebaseApp.auth();\r\nconst providers = {\r\n  googleProvider: new firebase.auth.GoogleAuthProvider()\r\n};\r\n\r\nexport default firebaseApp;\r\nexport { providers, firebaseAppAuth };\r\n","import { useState, useEffect } from \"react\";\r\n\r\ntype FirestoreDocState<T> = {\r\n  isLoading: boolean;\r\n  data: Array<T> | null;\r\n};\r\n\r\ntype Indexed = { id?: string; }\r\n\r\nexport const useFirestoreDoc = <T extends Indexed>(\r\n  ref: firebase.firestore.CollectionReference<T>\r\n) => {\r\n  const [docState, setDocState] = useState<FirestoreDocState<T>>({\r\n    isLoading: true,\r\n    data: null\r\n  });\r\n\r\n  useEffect(() => {\r\n    ref.onSnapshot(doc => {\r\n      setDocState({\r\n        isLoading: false,\r\n        data: doc.docs.map((x: firebase.firestore.QueryDocumentSnapshot<T>) => ({ ...x.data(), id: x.id }))\r\n      });\r\n    });\r\n  }, []);\r\n\r\n  return docState;\r\n};\r\n","import React from \"react\";\r\n\r\ninterface AppState {\r\n  user: firebase.User | null;\r\n}\r\nexport const AppStateContext = React.createContext<AppState>({ user: null});\r\n","import { useContext } from \"react\"\r\nimport { AppStateContext } from \"../contexts/AppStateContext\"\r\n\r\nexport const useAppState = () => {\r\n    const appState = useContext(AppStateContext);\r\n    return appState;\r\n}","import React, { Fragment, useState, useContext } from \"react\";\r\nimport { ReferenceEntry } from \"../../models/Entry\";\r\nimport firebaseApp from \"../../backend/firebase\";\r\nimport { useFirestoreDoc } from \"../../hooks/useFirestoreDoc\";\r\nimport { useAppState } from \"../../hooks/useAppState\";\r\nimport { User } from \"firebase\";\r\n\r\ntype RefSearchProps = {\r\n  onSelect: (ref: ReferenceEntry) => void;\r\n};\r\nexport const RefSearch = ({ onSelect }: RefSearchProps) => {\r\n  const { user } = useAppState();\r\n  const ref = firebaseApp\r\n    .firestore()\r\n    .collection(`users/${(user as User).uid}/references`);\r\n\r\n  // @ts-ignore\r\n  const { data: refs } = useFirestoreDoc<ReferenceEntry>(ref);\r\n  const [searchTerm, setSearchTerm] = useState<string>(\"\");\r\n\r\n  const clearInput = () => setSearchTerm(\"\");\r\n\r\n  const handleInputChange = (\r\n    event: React.ChangeEvent<HTMLInputElement>\r\n  ): void => {\r\n    //@ts-ignore\r\n    const term = event.target.value;\r\n    setSearchTerm(term);\r\n  };\r\n\r\n  const handleClick = (entry: ReferenceEntry) => (\r\n    event: React.MouseEvent<HTMLLIElement, MouseEvent>\r\n  ) => {\r\n    onSelect(entry);\r\n    clearInput();\r\n  };\r\n\r\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (event.key === \"Enter\") {\r\n      onSelect({\r\n        title: searchTerm,\r\n        tags: []\r\n      });\r\n      setSearchTerm(\"\");\r\n    }\r\n  };\r\n\r\n  const handleDropRefClick = (id?: string) => () => {\r\n    if (!id) return;\r\n    return firebaseApp\r\n      .firestore()\r\n      .collection(`users/${(user as User).uid}/references`)\r\n      .doc(id)\r\n      .delete();\r\n  };\r\n\r\n  const filtered =\r\n    searchTerm === \"\"\r\n      ? []\r\n      : refs?.filter((x: ReferenceEntry) => x.title.includes(searchTerm));\r\n  return (\r\n    <Fragment>\r\n      <div className=\"form-group\">\r\n        <label htmlFor=\"search\" className=\"sr-only\">\r\n          search for a ref\r\n        </label>\r\n        <input\r\n          type=\"search\"\r\n          className=\"form-control\"\r\n          id=\"search\"\r\n          placeholder=\"search for a ref\"\r\n          onChange={handleInputChange}\r\n          value={searchTerm}\r\n          onKeyDown={handleKeyDown}\r\n          autoComplete=\"off\"\r\n        />\r\n      </div>\r\n      {filtered ? (\r\n        <ul className=\"list-group list-group-flush\">\r\n          {filtered.map((entry: ReferenceEntry) => (\r\n            <li className=\"list-group-item\" key={entry.id}>\r\n              <div className=\"d-flex w-100 justify-content-between\">\r\n                <h5 className=\"mb-1\">{entry.title}</h5>\r\n                <span>\r\n                  <small className=\"link pointer\" onClick={handleClick(entry)}>\r\n                    [start]\r\n                  </small>{\" \"}\r\n                  <small\r\n                    className=\"link pointer\"\r\n                    onClick={handleDropRefClick(entry.id)}\r\n                  >\r\n                    [drop]\r\n                  </small>\r\n                </span>\r\n              </div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      ) : null}\r\n    </Fragment>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { ReferenceEntry } from \"../../models/Entry\";\r\nimport { RefSearch } from \"../RefSearch/RefSearch\";\r\nimport firebaseApp from \"../../backend/firebase\";\r\nimport moment from \"moment\";\r\nimport * as R from \"ramda\";\r\nimport { useAppState } from \"../../hooks/useAppState\";\r\n\r\nconst tagLens = R.lensProp(\"tags\");\r\n\r\nconst TagList = (\r\n  tags: Array<string> | undefined,\r\n  removeFn: (tag: string) => void\r\n) =>\r\n  tags\r\n    ? tags.map((tag, idx) => (\r\n        <span key={idx} className=\"badge badge-dark badge-pill\">\r\n          {tag}{\" \"}\r\n          <span className=\"link\" onClick={() => removeFn(tag)}>\r\n            x\r\n          </span>\r\n        </span>\r\n      ))\r\n    : null;\r\n\r\nexport const NewActivity = () => {\r\n  const [currentTag, setCurrentTag] = useState<string>(\"\");\r\n  const [selectedRef, setSelectedRef] = useState<ReferenceEntry>();\r\n  const { user } = useAppState();\r\n  const handleStartClick = async () => {\r\n    if (!selectedRef || !user) return;\r\n    firebaseApp\r\n      .firestore()\r\n      .collection(`users/${user.uid}/timeEntries`)\r\n      .add({\r\n        start: moment()\r\n          .utc()\r\n          .toISOString(),\r\n        title: selectedRef.title,\r\n        tags: selectedRef.tags\r\n      });\r\n\r\n    // Add reference if no ID exists on the ref\r\n    if (!selectedRef.id) {\r\n      firebaseApp\r\n        .firestore()\r\n        .collection(`users/${user.uid}/references`)\r\n        .add(selectedRef);\r\n    }\r\n    setSelectedRef(undefined);\r\n  };\r\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>): void => {\r\n    setCurrentTag(event.target.value);\r\n  };\r\n\r\n  const dropTag = (tag: string) =>\r\n    setSelectedRef(R.over(tagLens, R.filter(R.pipe(R.equals(tag), R.not))));\r\n\r\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (event.key === \"Enter\" && currentTag !== \"\") {\r\n      setSelectedRef(R.over(tagLens, R.concat([currentTag])));\r\n      setCurrentTag('');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <h5>Start something new</h5>\r\n      <div className=\"card\">\r\n        <div className=\"card-body\">\r\n          <RefSearch onSelect={setSelectedRef} />\r\n\r\n          <hr />\r\n          {selectedRef ? (\r\n            <div>\r\n              <h5 className=\"card-title\">{selectedRef.title}</h5>\r\n              <div>{TagList(selectedRef.tags, dropTag)}</div>\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"add-tag\" className=\"sr-only\">\r\n                  add a tag\r\n                </label>\r\n                <input\r\n                  type=\"search\"\r\n                  className=\"form-control\"\r\n                  id=\"add-tag\"\r\n                  placeholder=\"add a tag...\"\r\n                  autoComplete=\"off\"\r\n                  onChange={handleChange}\r\n                  value={currentTag}\r\n                  onKeyDown={handleKeyDown}\r\n                />\r\n              </div>\r\n              <button\r\n                className=\"btn btn-outline-success btn-block btn-sm\"\r\n                onClick={handleStartClick}\r\n              >\r\n                Start\r\n              </button>\r\n              <button className=\"btn btn-outline-success btn-block btn-sm\">\r\n                Instance\r\n              </button>\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\n\r\ntype DropButtonProps = { dropAction: () => Promise<void> };\r\n\r\nexport const DropButton = ({ dropAction }: DropButtonProps) => {\r\n  const [dropClicked, setDropClicked] = useState(false);\r\n  return dropClicked ? (\r\n    <span>\r\n      sure?{\" \"}\r\n      <span className=\"link pointer text-danger\" onClick={dropAction}>\r\n        yup\r\n      </span>{\" \"}\r\n      <span className=\"link pointer\" onClick={() => setDropClicked(false)}>\r\n        nah\r\n      </span>\r\n    </span>\r\n  ) : (\r\n    <span className=\"link pointer\" onClick={() => setDropClicked(true)}>\r\n      drop\r\n    </span>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { TimeEntry } from \"../../models/Entry\";\r\nimport moment from \"moment\";\r\nimport { DropButton } from \"../DropButton\";\r\nimport firebaseApp from \"../../backend/firebase\";\r\nimport { useAppState } from \"../../hooks/useAppState\";\r\nimport { User } from \"firebase\";\r\nimport Timeago from 'react-timeago';\r\n\r\nconst finishEntry = (user: User, id: string) => () => {\r\n  firebaseApp\r\n    .firestore()\r\n    .collection(`users/${user.uid}/timeEntries`)\r\n    .doc(id)\r\n    .update(\r\n      \"end\",\r\n      moment()\r\n        .utc()\r\n        .toISOString()\r\n    );\r\n};\r\n\r\nconst time = (entry: TimeEntry, user: firebase.User) => {\r\n  const badges = [\r\n    <span key=\"1\">\r\n      <em>{moment(entry.start).format(\"MM/DD HH:mm\")}</em>\r\n    </span>\r\n  ];\r\n\r\n  if (\"end\" in entry) {\r\n    const duration = moment(entry.end).diff(moment(entry.start), \"minutes\");\r\n    badges.push(\r\n      <span key=\"2\">\r\n        <em>\r\n          {\" \"}\r\n          - {moment(entry?.end).format(\"HH:mm\")} ({duration} minutes)\r\n        </em>\r\n      </span>\r\n    );\r\n  } else {\r\n    badges.push(\r\n      <span key=\"3\">\r\n        <em>\r\n          {\" \"}(<Timeago date={entry.start.toString()} />){\" \"}\r\n          <span className=\"link pointer\" onClick={finishEntry(user, entry.id)}>\r\n            finish\r\n          </span>\r\n        </em>\r\n      </span>\r\n    );\r\n  }\r\n\r\n  return badges;\r\n};\r\n\r\nconst dropForUser = (user: any, id: any) => () => {\r\n  return firebaseApp\r\n    .firestore()\r\n    .collection(`users/${user.uid}/timeEntries`)\r\n    .doc(id)\r\n    .delete();\r\n};\r\n\r\nexport const TimeEntryListItem = ({ entry }: { entry: TimeEntry }) => {\r\n  const { user } = useAppState();\r\n  return (\r\n    <li className=\"list-group-item list-group-item-action\" key={entry.id}>\r\n      <div className=\"d-flex w-100 justify-content-between\">\r\n        <p className=\"mb-1\">{entry.title}</p>\r\n        <small>\r\n          <DropButton dropAction={dropForUser(user, entry.id)} />\r\n        </small>\r\n      </div>\r\n      <div className=\"d-flex w-100 justify-content-between\">\r\n        {entry.tags ? (\r\n          <small>\r\n            <em>{entry.tags.join(\", \")}</em>\r\n          </small>\r\n        ) : null}\r\n        <small>{time(entry, (user as User))}</small>\r\n      </div>\r\n    </li>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { InstanceEntry } from \"../../models/Entry\";\r\nimport { DropButton } from \"../DropButton\";\r\n\r\nexport const InstanceEntryListItem = ({ entry }: { entry: InstanceEntry }) => {\r\n  return (\r\n    <li className=\"list-group-item list-group-item-action\" key={entry.id}>\r\n      <div className=\"d-flex w-100 justify-content-between\">\r\n        <p className=\"mb-1\">{entry.title}</p>\r\n        <small>\r\n          <DropButton dropAction={async () => {}} />\r\n        </small>\r\n      </div>\r\n      <div className=\"d-flex w-100 justify-content-between\">\r\n        {entry.data ? (\r\n          <small>\r\n            <em>\r\n              {typeof entry.data === \"string\"\r\n                ? entry.data\r\n                : entry?.data?.join(\", \")}\r\n            </em>\r\n          </small>\r\n        ) : null}\r\n        <small>\r\n          <em>{entry.time.format(\"MM/DD HH:mm\")}</em>\r\n        </small>\r\n      </div>\r\n    </li>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { ActivityEntry } from \"../../models/Entry\";\r\nimport Loader from \"react-loader-spinner\";\r\nimport { TimeEntryListItem } from \"../TimeEntryListItem/TimeEntryListItem\";\r\nimport { InstanceEntryListItem } from \"../InstanceEntryListItem/InstanceEntryListItem\";\r\n\r\nexport const ActivityList = ({\r\n  entries\r\n}: {\r\n  entries: Array<ActivityEntry> | null;\r\n}) => {\r\n  return (\r\n    <ul className=\"list-group\">\r\n      {entries === null ? (\r\n        <span className=\"d-flex justify-content-center\">\r\n          <Loader type=\"MutatingDots\" />\r\n        </span>\r\n      ) : (\r\n        entries.map((entry, k) => {\r\n          if (\"start\" in entry) {\r\n            return <TimeEntryListItem entry={entry} key={k} />;\r\n          }\r\n          else if (\"time\" in entry) {\r\n            return <InstanceEntryListItem entry={entry} key={k} />;\r\n          } \r\n          return null;\r\n        })\r\n      )}\r\n    </ul>\r\n  );\r\n};\r\n","import React, { Fragment } from \"react\";\r\nimport { ActivityEntry } from \"../../models/Entry\";\r\nimport { ActivityList } from \"../ActivityList/ActivityList\";\r\nimport firebaseApp from \"../../backend/firebase\";\r\nimport { useFirestoreDoc } from \"../../hooks/useFirestoreDoc\";\r\nimport { useAppState } from \"../../hooks/useAppState\";\r\n\r\nexport const RecentActivity = () => {\r\n  const {user} = useAppState();\r\n  const ref = firebaseApp\r\n    .firestore()\r\n    .collection(`users/${(user as firebase.User).uid}/timeEntries`)\r\n    .orderBy(\"start\", \"desc\")\r\n    .limit(5);\r\n\r\n  // @ts-ignore\r\n  const { data: entries } = useFirestoreDoc<ActivityEntry>(ref);\r\n\r\n  return (\r\n    <Fragment>\r\n      <h5>Recent</h5>\r\n      <ActivityList\r\n        entries={entries}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n","import React from \"react\";\r\n\r\nexport const Intro = ({ signIn }: any) => (\r\n  <div className=\"col-md-12\">\r\n    <div className=\"jumbotron\">\r\n      <h2 className=\"display-4\">Welcome to abstrakt</h2>\r\n      <p className=\"lead\"><em>take control of your time</em></p>\r\n      <button className=\"btn btn-outline-dark\" onClick={signIn}>Sign in with Google</button>\r\n    </div>\r\n  </div>\r\n);\r\n","import React, { useState, useEffect } from \"react\";\r\nimport \"./App.css\";\r\nimport { NewActivity } from \"./components/NewActivity/NewActivity\";\r\nimport { RecentActivity } from \"./components/RecentActivity/RecentActivity\";\r\nimport { TimeEntry, ActivityEntry, ReferenceEntry } from \"./models/Entry\";\r\nimport firebaseApp, { providers, firebaseAppAuth } from \"./backend/firebase\";\r\nimport withFirebaseAuth from \"react-with-firebase-auth\";\r\nimport { AppStateContext } from \"./contexts/AppStateContext\";\r\nimport { useAuth } from \"./hooks/useauth\";\r\nimport Loader from \"react-loader-spinner\";\r\nimport { Intro } from \"./components/Intro/Intro\";\r\n\r\ntype AppState = {\r\n  recent: Array<ActivityEntry>;\r\n  unfinished: Array<TimeEntry>;\r\n  references: Array<ReferenceEntry>;\r\n};\r\n\r\nfunction App({ signOut, signInWithGoogle }: any) {\r\n  const { initializing, user } = useAuth();\r\n\r\n  return (\r\n    <div className=\"container-xl\">\r\n      {!initializing && !user ? <Intro signIn={signInWithGoogle}/> : null}\r\n      {!initializing && user ? (\r\n        <AppStateContext.Provider value={{ user }}>\r\n          <div className=\"row\">\r\n            <div className=\"col-md-12\">\r\n              <p>\r\n                Hello, {user.displayName} [\r\n                <span className=\"link\" onClick={signOut}>\r\n                  sign out\r\n                </span>\r\n                ]\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-md-4\">\r\n              <NewActivity />\r\n            </div>\r\n            <div className=\"col-md-4\">\r\n              <RecentActivity />\r\n            </div>\r\n          </div>\r\n        </AppStateContext.Provider>\r\n      ) : (\r\n        null\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withFirebaseAuth({\r\n  providers,\r\n  firebaseAppAuth\r\n})(App);\r\n","import { useState, useEffect } from \"react\";\r\nimport firebase from \"firebase\";\r\n\r\nexport const useAuth = () => {\r\n  const [state, setState] = useState(() => {\r\n    const user = firebase.auth().currentUser;\r\n    return { initializing: !user, user };\r\n  });\r\n  function onChange(user: any) {\r\n    setState({ initializing: false, user });\r\n  }\r\n\r\n  useEffect(() => {\r\n    // listen for auth state changes\r\n    const unsubscribe = firebase.auth().onAuthStateChanged(onChange);\r\n    // unsubscribe to the listener when unmounting\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  return state;\r\n};\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\"\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n"],"sourceRoot":""}